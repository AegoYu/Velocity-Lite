<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Velocity Test</title>
    <script type="text/javascript" src="/seajs/sea.js"></script>
    <script type="text/javascript" src="/jquery/jquery-2.1.4.js"></script>
</head>

<body>
    <script id="tmpl" type="text/tmplate">
        #if($isTop)
        <div class="m-box m-box-mid">
            <div class="m-box-items">
                <div class="m-pp-title">
                    置顶
                </div>
            </div>
            #if($top) #parse("page/bubble/fragment/v_feedCard.html") #end
        </div>
        #end
        <div class="m-box m-box-mid">
            #if($isFirst)
            <div class="m-box-items">
                <div class="m-pp-title">
                    全部
                </div>
            </div>
            #end #foreach($item in $result) #parse("page/bubble/fragment/v_feedCard.html") #end
        </div>
        #if($isMoreFeed)
        <div class="m-box m-box-mid" data-newFeed="{{newFeed}}" data-node="more">
            <a href="javascript:void(0);" class="m-pp-link">请给我更多！</a>
        </div>
        #end
    </script>
    <script>
    seajs.config({
        alias: {
            'velocityjs': '/velocityjs/0.4.6/index',
            'getJson': '/getJson'
        }
    });

    seajs.use(["velocityjs", "getJson"], function(Velocity, json) {

        var getJson = function(param) {
            return new $.Deferred(function(deferred) {
                json.getJson(param, function(data) {
                    deferred.resolve();
                });
            });
        };
        getJson({
            wallId: 55,
            count: 20,
            version: 1,
            hasRecomFeed: 1,
            top: 1,
            feedTypes: "1",
            authcookie: "12Om3aIXqNPIOXoHBwm1hKxCRfo6qbm28Q3QPFJ8OqkjCzcSEd9a9LyyFVsQ3pFFCm3AXpb2",
            device_id: "216643ab53097b0bcdf4d30040d6213f",
            agenttype: 12
        }).then(function(data) {

        });
        var Parser = Velocity.Parser;
        var Compile = Velocity.Compile;

        var asts = Parser.parse(document.querySelector('#tmpl').innerHTML);
        var data = {
            isTop:
        };
        var s = (new Compile(asts)).render(data);
        console.log(s);
    });
    </script>
</body>

</html>
